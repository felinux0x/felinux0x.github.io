<div id="custom-cursor" class="fixed pointer-events-none z-[9999] translate-x-[-50%] translate-y-[-50%] transition-transform duration-100 ease-out hidden md:block">
    <div class="cursor-main relative w-2 h-2 bg-[var(--primary)] rounded-full flex items-center justify-center transition-all duration-300">
        <!-- Expanding ring on hover -->
        <div class="cursor-ring absolute w-8 h-8 border border-[var(--primary)] rounded-full opacity-0 scale-50 transition-all duration-300"></div>
    </div>
</div>

<style is:global>
    #custom-cursor.hovering .cursor-main {
        transform: scale(0.8);
    }
    
    #custom-cursor.hovering .cursor-ring {
        opacity: 0.8;
        transform: scale(1);
        animation: pulse 1.5s infinite;
    }

    #custom-cursor.clicking .cursor-main {
        transform: scale(1.5);
    }

    @keyframes pulse {
        0% { transform: scale(1); opacity: 0.8; }
        50% { transform: scale(1.2); opacity: 0.4; }
        100% { transform: scale(1); opacity: 0.8; }
    }
</style>

<script>
    const cursor = document.getElementById('custom-cursor');
    const inner = cursor?.querySelector('.cursor-inner');

    let mouseX = 0;
    let mouseY = 0;
    let cursorX = 0;
    let cursorY = 0;

    document.addEventListener('mousemove', (e) => {
        mouseX = e.clientX;
        mouseY = e.clientY;
    });

    // Smooth follow
    function animate() {
        let dx = mouseX - cursorX;
        let dy = mouseY - cursorY;
        
        cursorX += dx * 0.2;
        cursorY += dy * 0.2;

        if (cursor) {
            cursor.style.left = `${cursorX}px`;
            cursor.style.top = `${cursorY}px`;
        }

        requestAnimationFrame(animate);
    }
    animate();

    // Interaction tracking
    const updateCursorState = () => {
        const interactiveElements = 'a, button, input, textarea, [role="button"], .copy-button, .btn-regular, .link, .glitch-hover';
        
        document.querySelectorAll(interactiveElements).forEach(el => {
            el.addEventListener('mouseenter', () => cursor?.classList.add('hovering'));
            el.addEventListener('mouseleave', () => cursor?.classList.remove('hovering'));
        });
    };

    // Initial and on travel (Swup support)
    updateCursorState();
    document.addEventListener('swup:content:replace', updateCursorState);

    document.addEventListener('mousedown', () => cursor?.classList.add('clicking'));
    document.addEventListener('mouseup', () => cursor?.classList.remove('clicking'));
</script>
